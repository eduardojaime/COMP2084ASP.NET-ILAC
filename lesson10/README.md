# Instructions

### Demo 1 Improving our Shopping Cart page
- Open /Views/Shared/Layout.cshtml
    - On a browser, navigate to Google Fonts Material Icons > https://fonts.google.com/icons?selected=Material+Symbols+Outlined:shopping_cart:FILL@0;wght@400;GRAD@0;opsz@48&icon.query=shop
    - Add reference to material icons stylesheet
    - Add icon link to navigate to /Store/Cart
- Open /Views/Store/Cart.cshtml
    - Modify title to 'Your Cart'
    - Get rid of 'Create New' link
    - Add the following bootstrap classes to the table:
        - table-striped
        - table-hover
    - Remove the following columns from the table:
        - CustomerId
        - DateCreated
    - Move the product column to the first position
    - Add an extra table header with no text for the image thumbnail
    - Go to the foreach loop section:
        - Show product name in the first column
        - Remove CustomerId and DateCreated
        - Remove Edit and Details links
        - Add extra column for showing the thumbnail image
        - Modify the Delete link to point to a new action method called RemoveFromCart
- Run the application and add a new item to the cart
    - It will show an  "Object reference not set to an instance of an object" error or not show Product name
    - This is due to the way the model was created. We need to include Product information with each shopping cart item.
- Open /Controllers/StoreController.cs
    - Go the Cart action method
    - Add .Include(c => c.Product) to the LINQ query that gets the Carts
- Run the application again and verify. It only needs a few more changes
    - Generally, numbers should be right-aligned and text should be left-aligned.
    - Summarize total
    - Show Checkout and Keep Shopping links
- Open /Views/Store/Cart.cshtml
    - Inside the foreach loop
        - Add the text-right bootstrap class to all number columns
        - Format the price as currency using ToString("C")
        - Add a link to the product name to navigate to product details
    - Display the total amount and buttons
        - Use the ViewBag object to store the value of the sum of all prices, use this value in the view to display total
        - Add up each product price on each iteration of the loop
        - Add another row at the bottom of the table to display the total
        - Add two buttons at the bottom of the page: 
            - Keep Shopping > navigates to /Store/Index
            - Checkout > navigates to /Store/Checkout
- Open /Controllers/StoreController.cs
    - Create an action method for RemoveFromCart that accepts an int as parameter
    - Use a LINQ query to remove item from the Cart
    - Redirect back to Cart action method
        
### Demo 2 Handling Checkout
- Open /Controllers/StoreController.cs
    - Create a new action result called Checkout
    - Return View()
    - Apply the [Authorize] decorator to this action method to make sure only authenticated users can checkout. Anonymous users can add products to the cart but only authenticated users can actually shop.
- Right click in /Views/Store folder
    - Add > View > Razor View
    - Set view name to Checkout
    - Select the Create Template
    - Model class is Order
    - Click Add
- Run the application and verify these buttons.
- What can be improved on the Checkout view?
- Open /Views/Store/Checkout.cshtml
    - Remove Total, OrderDate and CustomerId which can be added programmatically
    - Modify input for address and make it a textArea element with a corresponding closing tag
    - Modify Submit button to read "Payment >>"
    - Add a required attribute for all input elements
- Open /Models/Order.cs
    - Add a Display decorator to PostalCode, FirstName, and LastName to add labels with a space
- Open /Controllers/StoreController.cs
    - Add a POST action method for Checkout()
        - Add the ValidateAntiForgeryToken to the action method to protect from CSRF attacks
        - Use [Bind()] to bind input values coming from the form to an Order object
        - Generate values for the following properties
            - OrderDate with the current UTC date
            - CustomerId from GetCustomerId()
            - Total calculated using LINQ
        - Use SessionsExtension object to store the order object
        - Redirect to Payment action method

### Demo 3 Implementing SessionExtensions
- Navigate to https://www.talkingdotnet.com/store-complex-objects-in-asp-net-core-session/
- Add a new folder to your solution called Extensions
- Add a new class called SessionExtensions
    - Make it static
    - Copy over SetObject and GetObject methods from the tutorial link
    - Add the required using statements at the top of your class:
        - Microsoft.AspNetCore.Http
        - Newtonsoft.Json
    - Include the link as a reference in the comment
- Open /Controllers/StoreController.cs
    - Import the Extensions namespace to be able to access the extension methods
- Add the order object to a session variable using SetObject